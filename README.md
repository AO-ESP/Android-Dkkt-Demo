# Пример AIDL сервиса для интеграции драйвера ККТ с ТС ПИоТ

## Интерфейс IService

### Назначение

Интерфейс IService предоставляет абстракцию для взаимодействия с фискальным сервисом, отвечающим за
управление финансовыми операциями, шифрование данных и контроль состояния оборудования. Он служит
основным контрактом между клиентскими приложениями и реализацией сервиса, обеспечивая
стандартизированный доступ к функциональности фискального устройства.

### Описание методов

1. `isReady()` Проверяет готовность сервиса к работе.

Возвращает: boolean — true, если сервис инициализирован и готов к выполнению операций; false в
противном случае.

*Примечание: Рекомендуется вызывать перед выполнением критических операций.*

2. `getVersion()` Возвращает версию сервиса.

Возвращает: ServiceVersion — объект, содержащий информацию о версии сервиса (например, мажорную,
минорную и патч-версию).

*Пример: ServiceVersion{ major: 1, minor: 2, patch: 3 }*

3. `getInn()` Возвращает ИНН (идентификационный номер налогоплательщика), связанный с фискальным
   устройством.

Возвращает: String — ИНН организации или ИП, зарегистрированных в фискальном накопителе.

Формат: 10 или 12 цифр в зависимости от типа налогоплательщика.

4. `getRegistrationNumber()` Возвращает регистрационный номер ККТ.

Возвращает: String — уникальный номер, присвоенный ККТ при регистрации в налоговой службе.

*Пример: "1234567890123456" (16 цифр).*

5. `getSerialNumber()` Возвращает серийный номер фискального накопителя.

Возвращает: String — заводской серийный номер устройства.

*Пример: "FN-1234-5678"*

6. `isShiftOpened()` Проверяет состояние смены.

Возвращает: boolean — true, если смена открыта (разрешено проведение операций); false — если смена
закрыта.

Примечание: Фискальные операции возможны только при открытой смене.

7. `openShift()` Открывает новую смену.

Возвращает: void

Исключения: Может генерировать исключение, если смена уже открыта или сервис не готов.

Примечание: Требует предварительной проверки isReady() и isShiftOpened().

8. `closeShift()` Закрывает текущую смену.

Возвращает: void

Исключения: Может генерировать исключение, если смена уже закрыта или есть незавершенные операции.

Примечание: После закрытия смены создается фискальный отчет (Z-отчет).

9. `getFiscalStorageInfo()` Возвращает информацию о фискальном накопителе.

Возвращает: IFiscalStorageInfo — объект, содержащий детальную информацию о ФН (срок действия,
память, состояние и т.д.).

Пример данных: срок действия, оставшееся количество документов, состояние ФН.

10. `getCashierHardwareInfo()` Возвращает информацию об аппаратном обеспечении кассового места.

Возвращает: ICashierDeviceInfo — объект, содержащий данные о подключенном оборудовании (фискальный
регистратор, принтер, дисплей и т.д.).

Пример данных: модель устройства, серийный номер, версия прошивки.

11. `encryptTrusted(in byte[] data)` Выполняет доверенное шифрование данных (например, для
    фискальных чеков).

Параметры:

data (byte[]) — исходные данные для шифрования.

Возвращает: TrustedEncryptionResult — объект, содержащий зашифрованные данные и контрольную
информацию.

Примечание: Используется для шифрования данных, которые должны быть защищены от изменений.

12. `encryptControlled(in byte[] data)` Выполняет управляемое шифрование данных.

Параметры:

data (byte[]) — исходные данные для шифрования.

Возвращает: ControlledEncryptionResult — объект, содержащий зашифрованные данные.

Примечание: Используется для шифрования данных с возможностью последующего контроля целостности.

13. `decryptTrusted(in byte[] control, in byte[] data)` Расшифровывает данные, зашифрованные методом
    доверенного шифрования.

Параметры:

control (byte[]) — контрольные данные для проверки целостности.

data (byte[]) — зашифрованные данные.

Возвращает: byte[] — расшифрованные данные.

Исключения: Может генерировать исключение при несовпадении контрольных данных.

14. `decryptControlled(in byte[] data)` Расшифровывает данные, зашифрованные методом управляемого
    шифрования.

Параметры:

data (byte[]) — зашифрованные данные.

Возвращает: byte[] — расшифрованные данные.

*Примечание: Предполагает, что контроль целостности выполняется отдельно.*

15. `resetEncryptionSequence()` Сбрасывает последовательность шифрования.

Возвращает: void

*Примечание: Используется для синхронизации состояний шифрования между клиентом и сервисом. Может
быть необходим после сбоев или перезапусков.*
